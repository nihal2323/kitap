<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sepet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Sepetim</h2>

        {% if cart %}
        <table class="table">
            <thead>
                <tr>
                    <th>Ürün</th>
                    <th>Fiyat</th>
                    <th>Miktar</th>
                    <th>Toplam</th>
                    <th>Aksiyon</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart.values %}
                <tr>
                    <td><img src="{{ item.image }}" alt="{{ item.name }}" width="50"> {{ item.name }}</td>
                    <td>{{ item.price }} ₺</td>
                    <td>
                        <a href="{% url 'update_cart' item.id 'increase' %}" class="btn btn-sm btn-outline-success">+</a>
                        {{ item.quantity }}
                        <a href="{% url 'update_cart' item.id 'decrease' %}" class="btn btn-sm btn-outline-danger">-</a>
                    </td>
                    <td>{{ item.price|floatformat:2 }} ₺</td>
                    <td><a href="{% url 'update_cart' item.id 'remove' %}" class="btn btn-sm btn-outline-warning">Sil</a></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h4>Toplam Fiyat: {{ total_price }} ₺</h4>

        <div class="d-flex justify-content-between mt-4">
            <a href="{% url 'shop' %}" class="btn btn-primary">Alışverişe Devam Et</a>
            <a href="{% url 'checkout' %}" class="btn btn-success">Satın Al</a>
        </div>

        {% else %}
        <div class="alert alert-warning" role="alert">
            Sepetiniz boş. Alışverişe başlamak için <a href="{% url 'cart' %}" class="alert-link">buraya tıklayın</a>.
        </div>
        {% endif %}

        <hr>

        <h2>Ürün Ekle</h2>
        <form method="POST" action="{% url 'cart' %}">
            {% csrf_token %}
            <div class="mb-3">
                <label for="product" class="form-label">Ürün Seçin</label>
                <select id="product" name="product_id" class="form-select">
                    {% for product in products %}
                    <option value="{{ product.id }}">{{ product.name }} - {{ product.price }} ₺</option>
                    {% endfor %}
                </select>
            </div>

            <div class="mb-3">
                <label for="quantity" class="form-label">Miktar</label>
                <input type="number" id="quantity" name="quantity" class="form-control" min="1" value="1" required>
            </div>

            <button type="submit" class="btn btn-primary">Sepete Ekle</button>
        </form>
    </div>
</body>
</html>
